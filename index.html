<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RevistaZen - DOI Gratuito</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f5f7fa; color: #333; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; padding: 0 20px; }
        
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1rem 0; }
        .logo { display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .logo-text { font-size: 1.8rem; font-weight: 700; }
        
        .page-section { display: none; }
        .page-section.active { display: block; }
        
        .hero { padding: 3rem 0; text-align: center; background: white; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 1rem; color: #2d3748; }
        .cta-button { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; padding: 1rem 2rem; border-radius: 50px; 
            border: none; font-weight: 700; cursor: pointer; margin-top: 1rem; 
            font-size: 1.1rem;
        }
        
        .upload-tool { padding: 2rem 0; min-height: 100vh; }
        .card { 
            background: white; border-radius: 12px; padding: 24px; 
            margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
        }
        
        .info-box {
            background: #eff6ff; border-left: 4px solid #3b82f6; 
            padding: 16px; border-radius: 8px; margin-bottom: 20px;
        }
        .info-box h3 { color: #1e40af; margin-bottom: 8px; font-size: 16px; }
        
        .doi-benefits {
            background: #f0fdf4; border-left: 4px solid #10b981;
            padding: 16px; border-radius: 8px; margin-bottom: 20px;
        }
        .doi-benefits h3 { color: #166534; margin-bottom: 8px; font-size: 16px; }
        .benefit-item { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
        .benefit-item i { color: #10b981; }
        
        .drop-zone { 
            border: 3px dashed #cbd5e0; border-radius: 12px; padding: 40px 20px; 
            text-align: center; cursor: pointer; background: #f8fafc; 
            transition: all 0.3s;
        }
        .drop-zone:hover { border-color: #667eea; background: #e0e7ff; }
        .upload-icon { font-size: 3rem; color: #667eea; margin-bottom: 1rem; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: #374151; }
        input[type="text"], textarea { 
            width: 100%; padding: 12px; border: 2px solid #e5e7eb; 
            border-radius: 8px; font-size: 14px; 
        }
        input:focus, textarea:focus { 
            outline: none; border-color: #667eea; 
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); 
        }
        
        .author-item { 
            background: #f9fafb; padding: 16px; border-radius: 8px; 
            margin-bottom: 12px; border: 1px solid #e5e7eb; 
        }
        .author-fixed { 
            background: #f0f9ff; padding: 16px; border-radius: 8px; 
            margin-bottom: 12px; border: 2px solid #a6ce39;
        }
        .btn { 
            width: 100%; padding: 16px; border: none; border-radius: 12px; 
            font-weight: 600; cursor: pointer; background: #667eea; color: white; 
            font-size: 16px;
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .status { padding: 16px; border-radius: 12px; margin-top: 20px; }
        .status-success { background: #f0fdf4; border: 2px solid #86efac; color: #166534; }
        .status-error { background: #fef2f2; border: 2px solid #fca5a5; color: #991b1b; }
        .status-info { background: #eff6ff; border: 2px solid #93c5fd; color: #1e40af; }
        
        .spinner { 
            border: 3px solid rgba(255,255,255,0.3); border-top-color: white; 
            border-radius: 50%; width: 20px; height: 20px; animation: spin 0.8s linear infinite; 
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .hidden { display: none !important; }
        .help-text { font-size: 12px; color: #6b7280; margin-top: 4px; }
        
        .author-row { display: flex; gap: 10px; margin-top: 8px; }
        .btn-small { 
            padding: 8px 16px; background: #ef4444; color: white; border: none; 
            border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600;
        }
        .btn-add { 
            background: none; border: none; color: #667eea; cursor: pointer; 
            font-weight: 600; margin-top: 8px; padding: 8px 0;
        }
        .orcid-badge {
            display: inline-flex; align-items: center; gap: 6px; background: #a6ce39; 
            color: white; padding: 4px 8px; border-radius: 12px; font-size: 11px; 
            font-weight: 600; margin-left: 8px;
        }
        
        .features-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem; margin-top: 2rem;
        }
        .feature-card {
            background: white; border-radius: 12px; padding: 1.5rem;
            text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .feature-icon {
            font-size: 2.5rem; margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo" onclick="showPage('home')">
                <div class="logo-text">RevistaZen</div>
            </div>
        </div>
    </header>

    <div id="homePage" class="page-section active">
        <section class="hero">
            <div class="container">
                <h1>üéì DOI Gratuito para Artigos Cient√≠ficos</h1>
                <p>Obtenha um identificador DOI permanente para sua pesquisa atrav√©s da RevistaZen</p>
                <button class="cta-button" onclick="showPage('upload')">
                    <i class="fas fa-rocket"></i> Publicar Meu Artigo
                </button>
            </div>
        </section>

        <section style="padding: 3rem 0; background: #f8fafc;">
            <div class="container">
                <div class="card">
                    <h2 style="text-align: center; margin-bottom: 2rem;">‚ú® Por que usar a RevistaZen?</h2>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-fingerprint"></i>
                            </div>
                            <h3>DOI Permanente</h3>
                            <p>Identificador √∫nico e permanente para seu artigo cient√≠fico</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h3>Reconhecimento Acad√™mico</h3>
                            <p>Fortale√ßa seu curr√≠culo Lattes e perfil de pesquisador</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>Certificado RevistaZen</h3>
                            <p>ORCID institucional garante autenticidade da publica√ß√£o</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <h3>Processo R√°pido</h3>
                            <p>DOI gerado em minutos, sem burocracia</p>
                        </div>
                    </div>
                </div>
                
                <div class="doi-benefits">
                    <h3>üéØ Benef√≠cios do DOI para sua Pesquisa:</h3>
                    <div class="benefit-item">
                        <i class="fas fa-check-circle"></i>
                        <span><strong>Cita√ß√£o Permanente</strong> - Seu artigo pode ser citado para sempre</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-check-circle"></i>
                        <span><strong>Visibilidade Global</strong> - Indexado no Google Scholar e bases internacionais</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-check-circle"></i>
                        <span><strong>Credibilidade Acad√™mica</strong> - Reconhecimento como pesquisador publicado</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-check-circle"></i>
                        <span><strong>Preserva√ß√£o Digital</strong> - Seu trabalho preservado permanentemente no Zenodo/CERN</span>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div id="uploadPage" class="page-section">
        <section class="upload-tool">
            <div class="container">
                <!-- Informa√ß√µes sobre o processo -->
                <div class="card">
                    <h2>üöÄ Publica√ß√£o com RevistaZen</h2>
                    
                    <div class="info-box">
                        <h3>üìñ Como funciona:</h3>
                        <p><strong>1.</strong> Fa√ßa upload do PDF do seu artigo</p>
                        <p><strong>2.</strong> Revise os metadados extra√≠dos automaticamente</p>
                        <p><strong>3.</strong> Clique em publicar e receba seu DOI permanente</p>
                        <p><strong>4.</strong> Use o DOI para citar em curr√≠culos, Lattes e publica√ß√µes</p>
                        <!-- Caixa com c√≥digo LaTeX para inclus√£o em uma p√°gina -->
<div style="font-family:system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; max-width:900px; margin:1rem auto;">
  <label style="display:block; margin-bottom:0.5rem; font-weight:600;">5.Exemplo de c√≥digo LaTeX (copiar/colar diretamente no seu editor):</label>
  <div style="position:relative; border:1px solid #ddd; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.04);">
    <textarea id="latexCode" readonly spellcheck="false"
      style="width:100%; height:520px; padding:1rem; font-family: 'Courier New', monospace; font-size:13px; line-height:1.35; border:0; resize:vertical; background:#fafafa;">
\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[brazilian]{babel}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{url}

\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[brazilian]{babel}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{url}

% --- METADADOS COMPAT√çVEIS COM REVISTAZEN ---
% Estrutura: Nome | Institui√ß√£o | ORCID
% O parser da RevistaZen detecta padr√µes "Nome | Institui√ß√£o | ORCID"
\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  urlcolor=cyan,
  pdftitle={Tutorial de Integra√ß√£o Autom√°tica: Do Advanced Scientific Paper Generator para a RevistaZen},
  pdfauthor={Carlos de Andrade, Alexandre},
  pdfsubject={Este tutorial detalha o processo de integra√ß√£o 100\% compat√≠vel entre o "Advanced Scientific Paper Generator" e a plataforma de publica√ß√£o "RevistaZen". O guia explica como os metadados (t√≠tulo, autor, resumo, palavras-chave) s√£o automaticamente embutidos no arquivo PDF durante a compila√ß√£o do LaTeX. Ao fazer o upload deste PDF na RevistaZen, a plataforma l√™ esses metadados e preenche automaticamente os formul√°rios de submiss√£o, agilizando o processo de publica√ß√£o e obten√ß√£o de um DOI permanente.},
  pdfkeywords={Integra√ß√£o Autom√°tica, LaTeX, Metadados PDF, RevistaZen, Advanced Scientific Paper Generator, Publica√ß√£o Cient√≠fica, DOI}
}

% Configura√ß√µes da p√°gina
\geometry{a4paper, margin=1in}
\pagestyle{fancy}
\fancyhf{}
\rhead{Tutorial de Integra√ß√£o}
\lhead{Advanced Scientific Paper Generator}
\cfoot{\thepage}

\title{\textbf{Tutorial de Integra√ß√£o Autom√°tica:}\\Do Advanced Scientific Paper Generator para a RevistaZen}

\author{
  S√âRGIO DE ANDRADE, PAULO\\[4pt]
  \small Faculdade de Guarulhos (FG), Guarulhos, S√£o Paulo\\
  \small \texttt{andradepsa@gmail.com}\\
  \small ORCID: \url{https://orcid.org/0009-0004-2555-3178}
}

\date{\today}

\begin{document}
\maketitle
\thispagestyle{empty}

\begin{abstract}
\noindent Este tutorial detalha o processo de integra√ß√£o 100\% compat√≠vel entre o "Advanced Scientific Paper Generator" e a plataforma de publica√ß√£o "RevistaZen". O guia explica como os metadados (t√≠tulo, autor, resumo, palavras-chave) s√£o automaticamente embutidos no arquivo PDF durante a compila√ß√£o do LaTeX. Ao fazer o upload deste PDF na RevistaZen, a plataforma l√™ esses metadados e preenche automaticamente os formul√°rios de submiss√£o, agilizando o processo de publica√ß√£o e obten√ß√£o de um DOI permanente.
\end{abstract}

\vspace{1cm}
\noindent \textbf{Palavras-chave:} Integra√ß√£o Autom√°tica, LaTeX, Metadados PDF, RevistaZen, Advanced Scientific Paper Generator, Publica√ß√£o Cient√≠fica, DOI.
\clearpage

\tableofcontents
\clearpage

\section{Introdu√ß√£o}
Bem-vindo a este guia pr√°tico! O \textbf{Advanced Scientific Paper Generator} foi projetado para funcionar em perfeita harmonia com a \textbf{RevistaZen}. Esta compatibilidade de 100\% permite um fluxo de trabalho cont√≠nuo, automatizado e livre de erros, desde a cria√ß√£o do artigo at√© a obten√ß√£o de um DOI permanente.

\section{Pr√©-requisitos}
\begin{itemize}
\item C√≥digo-fonte LaTeX gerado pelo Advanced Scientific Paper Generator.
\item Compilador LaTeX (Overleaf, TeX Live, MiKTeX ou MacTeX).
\item Acesso √† plataforma \textbf{RevistaZen}.
\end{itemize}

\section{Guia Passo a Passo}
\subsection{Passo 1: Gerar o c√≥digo LaTeX}
Use o gerador para criar o artigo e copie o c√≥digo da se√ß√£o ‚ÄúFinal LaTeX Source‚Äù.

\subsection{Passo 2: Compilar o PDF}
Cole o c√≥digo em seu compilador LaTeX e compile para gerar o arquivo PDF com metadados embutidos.

\subsection{Passo 3: Fazer upload na RevistaZen}
Envie o PDF gerado para a plataforma RevistaZen.  
Os campos **Nome**, **Institui√ß√£o/Afilia√ß√£o** e **ORCID** ser√£o extra√≠dos automaticamente dos metadados.

\section{Conclus√£o}
A integra√ß√£o entre o \textbf{Advanced Scientific Paper Generator} e a \textbf{RevistaZen} representa um avan√ßo na automa√ß√£o da publica√ß√£o cient√≠fica.  
Os metadados incorporados tornam o processo mais r√°pido, preciso e confi√°vel.

\end{document}

    </textarea>
    <div style="position:absolute; top:8px; right:8px;">
      <button id="copyBtn" style="background:#0366d6; color:#fff; border:0; padding:0.45rem 0.7rem; border-radius:6px; cursor:pointer; font-weight:600;">Copiar</button>
    </div>
  </div>
  <small style="display:block; margin-top:0.5rem; color:#555;">Dica: cole diretamente no seu editor LaTeX/Overleaf.</small>
</div>

<script>
  document.getElementById('copyBtn').addEventListener('click', function(){
    const ta = document.getElementById('latexCode');
    ta.select();
    try {
      document.execCommand('copy');
      this.textContent = 'Copiado!';
      setTimeout(()=> this.textContent = 'Copiar', 1600);
    } catch(e) {
      alert('Use Ctrl+C / Cmd+C para copiar manualmente.');
    }
  });
</script>

                    </div>
                    
                    <div class="doi-benefits">
                        <h3>üéì O que voc√™ recebe:</h3>
                        <p>‚Ä¢ <strong>DOI Permanente</strong> - Identificador √∫nico internacional</p>
                        <p>‚Ä¢ <strong>Certificado RevistaZen</strong> - ORCID institucional de autenticidade</p>
                        <p>‚Ä¢ <strong>Indexa√ß√£o Autom√°tica</strong> - No Google Scholar e bases acad√™micas</p>
                        <p>‚Ä¢ <strong>Preserva√ß√£o Digital</strong> - No reposit√≥rio Zenodo/CERN</p>
                    </div>
                </div>

                <!-- Upload Section -->
                <div class="card">
                    <h2>üì§ Upload do Artigo</h2>
                    <p style="color: #718096; margin-bottom: 20px;">Fa√ßa upload do PDF do seu artigo LaTeX</p>
                    
                    <div id="dropZone" class="drop-zone">
                        <input type="file" id="pdfFile" accept=".pdf" class="hidden">
                        <div id="uploadPrompt">
                            <i class="fas fa-cloud-upload-alt upload-icon"></i>
                            <p style="font-weight: 600; color: #374151; margin-bottom: 8px;">
                                Clique ou arraste seu PDF aqui
                            </p>
                            <p style="color: #6b7280; font-size: 14px;">
                                Suporte otimizado para artigos LaTeX
                            </p>
                        </div>
                        <div id="loadingPrompt" class="hidden">
                            <div class="spinner" style="width: 40px; height: 40px; margin: 0 auto 16px;"></div>
                            <p style="font-weight: 600; color: #667eea;">Processando PDF...</p>
                            <p style="color: #6b7280; font-size: 14px; margin-top: 8px;">
                                Extraindo metadados automaticamente
                            </p>
                        </div>
                        <div id="successPrompt" class="hidden">
                            <i class="fas fa-check-circle" style="font-size: 40px; margin-bottom: 16px; color: #10b981;"></i>
                            <p id="fileName" style="font-weight: 600; color: #10b981;"></p>
                            <p style="color: #6b7280; font-size: 14px; margin-top: 8px;">
                                Clique para trocar o arquivo
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Metadata Form -->
                <div id="metadataForm" class="card hidden">
                    <h2>üìù Metadados do Artigo</h2>
                    <p style="color: #718096; margin-bottom: 20px;">Revise e ajuste as informa√ß√µes extra√≠das do seu artigo</p>
                    
                    <div class="form-group">
                        <label for="title">T√≠tulo do Artigo *</label>
                        <input type="text" id="title" placeholder="T√≠tulo completo do artigo">
                        <p class="help-text">Este ser√° o t√≠tulo permanente do seu DOI</p>
                    </div>

                    <div class="form-group">
                        <label for="description">Resumo/Abstract *</label>
                        <textarea id="description" rows="4" placeholder="Resumo ou abstract do artigo"></textarea>
                        <p class="help-text">Resumo que aparecer√° nas buscas acad√™micas</p>
                    </div>

                    <div class="form-group">
                        <label>üë• Autores do Artigo 
                            <span class="orcid-badge">
                                <i class="fab fa-orcid"></i> RevistaZen: 0009-0007-6299-2008
                            </span>
                        </label>
                        
                        <div class="info-box" style="margin-bottom: 16px;">
                            <h3>üí° Informa√ß√£o sobre Autores:</h3>
                            <p><strong>Formato recomendado:</strong> "Sobrenome, Nome" (ex: Silva, Jo√£o)</p>
                            <p><strong>ORCID pessoal:</strong> Opcional, mas recomendado para maior credibilidade</p>
                        </div>
                        
                        <!-- AUTORES DO PDF (edit√°veis) -->
                        <div id="authorsList"></div>
                        
                        <!-- AUTOR FIXO RevistaZen (N√ÉO edit√°vel) -->
                        <div class="author-fixed">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div>
                                    <strong>RevistaZen</strong>
                                    <span style="color: #6b7280; font-size: 14px; margin-left: 8px;">
                                        - Plataforma de Publica√ß√£o Cient√≠fica
                                    </span>
                                </div>
                                <span class="orcid-badge">
                                    <i class="fab fa-orcid"></i> 0009-0007-6299-2008
                                </span>
                            </div>
                            <div style="color: #a6ce39; font-size: 12px; margin-top: 4px;">
                                <i class="fas fa-lock"></i> ORCID institucional fixo - Garante autenticidade da publica√ß√£o
                            </div>
                        </div>
                        
                        <button class="btn-add" onclick="addAuthor()">
                            <i class="fas fa-plus"></i> Adicionar outro autor
                        </button>
                    </div>

                    <div class="form-group">
                        <label for="keywords">Palavras-chave</label>
                        <input type="text" id="keywords" placeholder="palavra1, palavra2, palavra3">
                        <p class="help-text">Separe por v√≠rgula - Melhora a descoberta do seu artigo</p>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="card">
                    <div class="info-box" style="background: #f0fdf4; border-left-color: #10b981; margin-bottom: 16px;">
                        <h3 style="color: #166534;">‚úÖ Pronto para Publicar!</h3>
                        <p style="color: #166534; margin: 0;">
                            Ap√≥s a publica√ß√£o, voc√™ receber√° um <strong>DOI permanente</strong> que poder√° usar em:
                            curr√≠culos Lattes, projetos de pesquisa, cita√ß√µes acad√™micas e muito mais!
                        </p>
                    </div>
                    
                    <button id="submitBtn" class="btn" onclick="submitToZenodo()" disabled>
                        <span id="submitBtnText">üöÄ Gerar DOI Permanente</span>
                    </button>
                </div>

                <!-- Status Area -->
                <div id="statusArea"></div>
            </div>
        </section>
    </div>

    <script>
        // PDF.js setup
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        // Global variables
        let selectedFile = null;
        let extractedFullText = '';
        
        // ORCID FIXO da RevistaZen (NUNCA altera)
        const REVISTAZEN_ORCID = '0009-0007-6299-2008';
        
        // Autores do PDF (edit√°veis)
        let authors = [{
            name: 'S√©rgio de Andrade, Paulo', // Formato Zenodo
            affiliation: 'Faculdade de Guarulhos (FG), Guarulhos, S√£o Paulo',
            orcid: '0009-0004-2555-3178'
        }];

        // Page Navigation
        function showPage(pageName) {
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(pageName + 'Page').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Setup drag and drop
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('pdfFile');

        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#667eea';
            dropZone.style.background = '#e0e7ff';
        });
        dropZone.addEventListener('dragleave', () => {
            dropZone.style.borderColor = '#cbd5e0';
            dropZone.style.background = '#f8fafc';
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#cbd5e0';
            dropZone.style.background = '#f8fafc';
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        // Handle file selection
        async function handleFile(file) {
            if (file.type !== 'application/pdf') {
                showStatus('‚ùå Por favor, selecione um arquivo PDF v√°lido.', 'error');
                return;
            }

            selectedFile = file;
            
            // Update UI
            document.getElementById('uploadPrompt').classList.add('hidden');
            document.getElementById('successPrompt').classList.add('hidden');
            document.getElementById('loadingPrompt').classList.remove('hidden');

            // Extract text from PDF
            await extractPDFText(file);
        }

        // Extract text from PDF using PDF.js
        async function extractPDFText(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
                
                // Try to get metadata from PDF properties
                const metadata = await pdf.getMetadata();
                let hasMetadata = false;
                
                if (metadata && metadata.info) {
                    const info = metadata.info;
                    
                    // Title from PDF metadata
                    if (info.Title && info.Title.trim().length > 0) {
                        document.getElementById('title').value = info.Title.trim();
                        hasMetadata = true;
                    }
                    
                    // Description/Abstract from PDF Subject
                    if (info.Subject && info.Subject.trim().length > 0) {
                        document.getElementById('description').value = info.Subject.trim();
                        hasMetadata = true;
                    }
                    
                    // Keywords from PDF metadata
                    if (info.Keywords && info.Keywords.trim().length > 0) {
                        document.getElementById('keywords').value = info.Keywords.trim();
                        hasMetadata = true;
                    }
                    
                    // Author from PDF metadata - USA O FORMATO QUE VEM DO PDF
                    if (info.Author && info.Author.trim().length > 0) {
                        authors[0].name = info.Author.trim(); // MANT√âM O FORMATO ORIGINAL
                        hasMetadata = true;
                    }
                }
                
                // If we got metadata, we're mostly done!
                if (hasMetadata) {
                    showStatus('‚úÖ Metadados extra√≠dos do PDF com sucesso! Verifique e ajuste se necess√°rio.', 'success');
                } else {
                    // Fallback: Extract from text content
                    let fullText = '';
                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        const pageText = textContent.items.map(item => item.str).join(' ');
                        fullText += pageText + '\n';
                    }
                    
                    extractedFullText = fullText;
                    autoFillMetadata(fullText, file.name);
                    showStatus('‚úÖ PDF processado com sucesso! Verifique os metadados extra√≠dos.', 'success');
                }
                
                renderAuthors();
                
                // Show form and enable submit
                document.getElementById('metadataForm').classList.remove('hidden');
                document.getElementById('submitBtn').disabled = false;

                // Update UI
                document.getElementById('loadingPrompt').classList.add('hidden');
                document.getElementById('successPrompt').classList.remove('hidden');
                document.getElementById('fileName').textContent = `‚úÖ ${file.name}`;

            } catch (error) {
                console.error('Error extracting PDF:', error);
                
                document.getElementById('metadataForm').classList.remove('hidden');
                document.getElementById('submitBtn').disabled = false;
                renderAuthors();
                
                document.getElementById('loadingPrompt').classList.add('hidden');
                document.getElementById('successPrompt').classList.remove('hidden');
                document.getElementById('fileName').textContent = `‚úÖ ${file.name}`;

                showStatus('‚ö†Ô∏è PDF carregado com sucesso. Por favor, preencha os metadados manualmente.', 'info');
            }
        }

        // Auto-fill metadata from text - USA SEMPRE O FORMATO ORIGINAL
        function autoFillMetadata(text, filename) {
            text = text.replace(/^[\s\S]*?(springer|nature|latex|template)[\s\S]*?\n/im, '');
            
            const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
            
            // TITLE EXTRACTION
            let potentialTitle = '';
            
            for (let i = 0; i < Math.min(lines.length, 20); i++) {
                const line = lines[i];
                
                if (line.match(/springer|nature|latex|template|preprint|draft/i)) continue;
                if (line.match(/[@]/i)) continue;
                if (line.match(/orcid|lattes|id:/i)) continue;
                if (line.match(/^graduate|^faculdade|^university/i)) continue;
                if (line.length < 30) continue;
                if (line.length > 200) continue;
                if (line.match(/^\d+\s/)) continue;
                if (line.split(/\s+/).length < 5) continue;
                if (line.match(/^[A-Z√Ä-√ö\s]+$/) && line.split(/\s+/).length <= 6) continue;
                
                potentialTitle = line;
                break;
            }
            
            if (!potentialTitle) {
                potentialTitle = filename.replace('.pdf', '').replace(/_/g, ' ');
            }
            
            document.getElementById('title').value = potentialTitle.trim();

            // ABSTRACT EXTRACTION
            let abstract = '';
            const abstractIndex = text.search(/\babstract\b/i);
            if (abstractIndex !== -1) {
                const afterAbstract = text.substring(abstractIndex + 8);
                const endMatch = afterAbstract.search(/\b(keywords?|palavras-chave|introduction|introdu√ß√£o|1\s+introduction)\b/i);
                
                if (endMatch !== -1) {
                    abstract = afterAbstract.substring(0, endMatch);
                } else {
                    abstract = afterAbstract.substring(0, 2000);
                }
                
                abstract = abstract.replace(/\s+/g, ' ').replace(/\n/g, ' ').trim();
                document.getElementById('description').value = abstract;
            }

            // KEYWORDS EXTRACTION
            const keywordsMatch = text.match(/keywords?[:\s]+(.+?)(?:\n\n|introduction|1\s+introduction|\d+\s+\w+)/is);
            if (keywordsMatch) {
                let keywords = keywordsMatch[1]
                    .replace(/\n/g, ' ')
                    .replace(/\s+/g, ' ')
                    .replace(/[;.]/g, ',')
                    .trim();
                
                keywords = keywords.replace(/,+/g, ',').replace(/,\s*$/, '');
                document.getElementById('keywords').value = keywords;
            }

            // AUTHOR EXTRACTION - MANT√âM O FORMATO ORIGINAL
            const titleIndex = text.indexOf(potentialTitle);
            const abstractStartIndex = text.search(/\babstract\b/i);
            
            if (titleIndex !== -1 && abstractStartIndex !== -1) {
                const betweenTitleAndAbstract = text.substring(titleIndex + potentialTitle.length, abstractStartIndex);
                const betweenLines = betweenTitleAndAbstract.split('\n').map(l => l.trim()).filter(l => l.length > 0);
                
                let authorName = '';
                let affiliation = '';
                let orcid = '';
                
                for (let i = 0; i < betweenLines.length; i++) {
                    const line = betweenLines[i];
                    
                    // USA O FORMATO ORIGINAL - N√ÉO ALTERA
                    if (!authorName && line.match(/^[A-Z√Ä-√ö][A-Z√Ä-√öa-z√†-√∫\s,]+$/)) {
                        authorName = line; // MANT√âM O FORMATO ORIGINAL
                        continue;
                    }
                    
                    if (authorName && !affiliation && line.match(/faculdade|university|instituto|college|guarulhos|s√£o paulo/i)) {
                        affiliation = line.replace(/@.*$/, '').replace(/lattes.*$/i, '').replace(/orcid.*$/i, '').trim();
                        continue;
                    }
                    
                    const orcidMatch = line.match(/orcid[:\s]+([0-9-]+)/i);
                    if (orcidMatch) {
                        orcid = orcidMatch[1];
                    }
                }
                
                if (authorName) {
                    authors = [{
                        name: authorName, // FORMATO ORIGINAL
                        affiliation: affiliation || '',
                        orcid: orcid || ''
                    }];
                }
            }

            renderAuthors();
        }

        // Render authors list
        function renderAuthors() {
            const container = document.getElementById('authorsList');
            container.innerHTML = '';
            
            // MOSTRA APENAS AUTORES DO PDF (edit√°veis)
            authors.forEach((author, index) => {
                const authorDiv = document.createElement('div');
                authorDiv.className = 'author-item';
                authorDiv.innerHTML = `
                    <input type="text" value="${author.name}" onchange="updateAuthor(${index}, 'name', this.value)" 
                           placeholder="Nome (formato: Sobrenome, Nome)" 
                           style="width: 100%; padding: 10px; border: 1px solid #e5e7eb; border-radius: 6px; margin-bottom: 8px;">
                    <input type="text" value="${author.affiliation}" onchange="updateAuthor(${index}, 'affiliation', this.value)" 
                           placeholder="Institui√ß√£o/Afilia√ß√£o" 
                           style="width: 100%; padding: 10px; border: 1px solid #e5e7eb; border-radius: 6px; margin-bottom: 8px;">
                    <div class="author-row">
                        <input type="text" value="${author.orcid}" onchange="updateAuthor(${index}, 'orcid', this.value)" 
                               placeholder="ORCID pessoal (opcional)" 
                               style="flex: 1; padding: 10px; border: 1px solid #e5e7eb; border-radius: 6px;">
                        ${authors.length > 1 ? `<button onclick="removeAuthor(${index})" class="btn-small">Remover</button>` : ''}
                    </div>
                `;
                container.appendChild(authorDiv);
            });
        }

        function addAuthor() {
            authors.push({ name: '', affiliation: '', orcid: '' });
            renderAuthors();
        }

        function updateAuthor(index, field, value) {
            authors[index][field] = value;
        }

        function removeAuthor(index) {
            if (authors.length > 1) {
                authors.splice(index, 1);
                renderAuthors();
            }
        }

        // Submit to Zenodo - CORRE√á√ÉO: DOIS AUTORES SEPARADOS NO CAMPO CREATORS
        async function submitToZenodo() {
            const token = "cYYoVEoLqiIZDyeZ5A88SCxhlbvDXwmT7Tma1aQnYVAWeGtqlWp0KsSbWTHC";
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const keywords = document.getElementById('keywords').value;

            if (!selectedFile) {
                showStatus('‚ùå Por favor, selecione um arquivo PDF.', 'error');
                return;
            }

            if (!title || !description) {
                showStatus('‚ùå Por favor, preencha o t√≠tulo e a descri√ß√£o do artigo.', 'error');
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            submitBtn.disabled = true;
            submitBtnText.innerHTML = '<div class="spinner"></div> Gerando DOI...';

            const baseUrl = 'https://zenodo.org/api';

            try {
                showStatus('üìù Criando dep√≥sito oficial no Zenodo...', 'info');
                const createResponse = await fetch(`${baseUrl}/deposit/depositions`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({})
                });

                if (!createResponse.ok) {
                    throw new Error(`Erro ao criar dep√≥sito (${createResponse.status})`);
                }

                const deposit = await createResponse.json();

                showStatus('üì§ Fazendo upload do arquivo PDF...', 'info');
                const formData = new FormData();
                formData.append('file', selectedFile);

                const uploadResponse = await fetch(`${baseUrl}/deposit/depositions/${deposit.id}/files`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });

                if (!uploadResponse.ok) {
                    throw new Error(`Erro ao fazer upload (${uploadResponse.status})`);
                }

                showStatus('üìã Registrando metadados e ORCIDs...', 'info');
                const keywordsArray = keywords.split(',').map(k => k.trim()).filter(k => k.length > 0);
                
                // ‚úÖ CORRE√á√ÉO: DOIS AUTORES SEPARADOS NO CAMPO CREATORS
                const allCreators = [
                    // Autores do PDF (edit√°veis)
                    ...authors.filter(a => a.name.trim().length > 0).map(author => ({
                        name: author.name,
                        affiliation: author.affiliation,
                        orcid: author.orcid || undefined // ORCID pessoal (opcional)
                    })),
                    
                    // Autor FIXO RevistaZen (NUNCA altera)
                    {
                        name: "RevistaZen",
                        affiliation: "Plataforma de Publica√ß√£o Cient√≠fica",
                        orcid: REVISTAZEN_ORCID // ORCID FIXO
                    }
                ];
                
                const metadata = {
                    metadata: {
                        title: title,
                        upload_type: 'publication',
                        publication_type: 'article',
                        description: description,
                        creators: allCreators,
                        keywords: keywordsArray.length > 0 ? keywordsArray : undefined
                    }
                };

                const metadataResponse = await fetch(`${baseUrl}/deposit/depositions/${deposit.id}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(metadata)
                });

                if (!metadataResponse.ok) {
                    throw new Error(`Erro ao atualizar metadados (${metadataResponse.status})`);
                }

                showStatus('üéØ Publicando artigo e gerando DOI permanente...', 'info');
                const publishResponse = await fetch(`${baseUrl}/deposit/depositions/${deposit.id}/actions/publish`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!publishResponse.ok) {
                    throw new Error(`Erro ao publicar (${publishResponse.status})`);
                }

                const published = await publishResponse.json();
                const zenodoLink = `https://zenodo.org/records/${deposit.id}`;

                let successMsg = `
                    <div style="text-align: center;">
                        <h3 style="color: #10b981; font-size: 1.8rem; margin-bottom: 1rem;">üéâ Parab√©ns! Artigo Publicado!</h3>
                        
                        <div style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); padding: 24px; border-radius: 16px; border: 3px solid #10b981; margin: 20px 0;">
                            <p style="font-size: 1.2rem; color: #166534; font-weight: 700; margin-bottom: 16px;">üéØ SEU DOI PERMANENTE</p>
                            <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <a href="https://doi.org/${published.doi}" target="_blank" 
                                   style="color: #667eea; word-break: break-all; font-family: 'Courier New', monospace; font-size: 1.3rem; font-weight: bold; display: block;">
                                   ${published.doi}
                                </a>
                            </div>
                            <p style="margin-top: 16px; color: #166534; font-weight: 600;">
                                ‚úÖ Use este DOI para citar em curr√≠culos Lattes, projetos e publica√ß√µes!
                            </p>
                        </div>
                        
                        <div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid #93c5fd; margin: 20px 0;">
                            <p style="margin-bottom: 12px; font-weight: 600; color: #1e40af;">
                                <i class="fas fa-link"></i> Link da Publica√ß√£o:
                            </p>
                            <a href="${zenodoLink}" target="_blank" style="color: #667eea; word-break: break-all; font-size: 1rem;">
                                ${zenodoLink}
                            </a>
                            <p style="margin-top: 12px; color: #4b5563; font-size: 0.9rem;">
                                üìä Acesse para ver estat√≠sticas de visualiza√ß√µes e downloads
                            </p>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); padding: 20px; border-radius: 12px; border: 2px solid #3b82f6; margin-top: 24px;">
                            <p style="color: #1e40af; font-weight: 700; font-size: 1.2rem; margin: 0 0 12px 0;">
                                ‚ú® PUBLICA√á√ÉO OFICIAL REGISTRADA
                            </p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px;">
                                <div style="text-align: left;">
                                    <p style="color: #4b5563; font-size: 0.9rem; margin: 4px 0;">
                                        <i class="fas fa-check-circle" style="color: #10b981;"></i> DOI Permanente
                                    </p>
                                    <p style="color: #4b5563; font-size: 0.9rem; margin: 4px 0;">
                                        <i class="fas fa-check-circle" style="color: #10b981;"></i> Indexado Globalmente
                                    </p>
                                </div>
                                <div style="text-align: left;">
                                    <p style="color: #4b5563; font-size: 0.9rem; margin: 4px 0;">
                                        <i class="fab fa-orcid" style="color: #a6ce39;"></i> ORCID RevistaZen
                                    </p>
                                    <p style="color: #4b5563; font-size: 0.9rem; margin: 4px 0;">
                                        <i class="fas fa-check-circle" style="color: #10b981;"></i> Preserva√ß√£o CERN
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                showStatus(successMsg, 'success');
                submitBtnText.innerHTML = '<i class="fas fa-check-circle"></i> DOI Gerado!';

            } catch (error) {
                console.error('Error:', error);
                showStatus(`‚ùå Erro na publica√ß√£o: ${error.message}`, 'error');
                submitBtn.disabled = false;
                submitBtnText.textContent = 'üöÄ Gerar DOI Permanente';
            }
        }

        // Show status message
        function showStatus(message, type) {
            const statusArea = document.getElementById('statusArea');
            const classes = {
                success: 'status-success',
                error: 'status-error',
                info: 'status-info'
            };

            statusArea.innerHTML = `
                <div class="status ${classes[type]}">
                    ${message}
                </div>
            `;
            
            statusArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Initialize
        renderAuthors();
    </script>
</body>
</html>
